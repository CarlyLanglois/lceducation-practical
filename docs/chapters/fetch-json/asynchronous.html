<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>24.4. Asynchronous and Promises &#8212; Introduction to Professional Web Development in JavaScript  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/site.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="24.5. Exercises" href="exercises.html" />
    <link rel="prev" title="24.3. Fetching Data" href="fetch.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body class="body-bc">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
        </a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<ol class="breadcrumb container">
    <li><a href="../../index.html">Contents</a></li>
    <li><a href="index.html">24. Fetch &amp; JSON</a></li>
    <li class="active">24.4. Asynchronous and Promises</li>
</ol>



<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1 content ">

    
  <div class="section" id="asynchronous-and-promises">
<h1>24.4. Asynchronous and Promises<a class="headerlink" href="#asynchronous-and-promises" title="Permalink to this headline">¶</a></h1>
<span class="target" id="index-0"></span><span class="target" id="index-1"></span><p id="index-2">In order to fully explain how the <code class="docutils literal notranslate"><span class="pre">fetch</span></code> function works, we need to define
and talk about the terms <strong>asynchronous</strong> and <strong>synchronous</strong>.</p>
<blockquote>
<div><p>Asynchronous: Not simultaneous or concurrent in time.</p>
<p>Synchronous: Simultaneous or concurrent in time.</p>
</div></blockquote>
<p>When fetching data in JavaScript, the HTTP requests are asynchronous. In brief that means
when an HTTP request is sent, we don’t know exactly when a response will be received by the browser.
Remember that HTTP requests are sent to an address, then a response is sent. That process takes
a variable amount of time depending on network speed, the address location, and response size.</p>
<div class="admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p class="last">These requests are also called <strong>AJAX requests</strong> (Asynchronous JavaScript and XML). The XML
part of AJAX refers to a data format that was popular before JSON.</p>
</div>
<div class="section" id="response-handlers">
<h2>24.4.1. Response Handlers<a class="headerlink" href="#response-handlers" title="Permalink to this headline">¶</a></h2>
<p>Browsers can’t stop everything and wait for a response to an HTTP request. Browsers have
to render HTML, interact with the user, and run JavaScript. To keep these processes running
seamlessly, without any noticeable pauses, the browser relies on events.</p>
<p>This is where <code class="docutils literal notranslate"><span class="pre">then</span></code> and the response handler function come in. The browser provides us
with a way to handle the response whenever it is received.</p>
</div>
<div class="section" id="promises-and-the-then-function">
<h2>24.4.2. Promises and the <code class="docutils literal notranslate"><span class="pre">then</span></code> Function<a class="headerlink" href="#promises-and-the-then-function" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-3"></span><p id="index-4">Let’s look again at a simple <code class="docutils literal notranslate"><span class="pre">fetch</span></code> example. Notice on line 1 that <code class="docutils literal notranslate"><span class="pre">then</span></code> is called
on the value returned from <code class="docutils literal notranslate"><span class="pre">fetch()</span></code>.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://api.education.launchcode.org/weather&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">}</span> <span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>To make it clearer, let’s capture the value returned by <code class="docutils literal notranslate"><span class="pre">fetch</span></code> in a variable named <code class="docutils literal notranslate"><span class="pre">promise</span></code>.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">promise</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://api.education.launchcode.org/weather&#39;</span><span class="p">);</span>
<span class="nx">promise</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">}</span> <span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p><code class="docutils literal notranslate"><span class="pre">fetch</span></code> returns an instance of the <code class="docutils literal notranslate"><span class="pre">Promise</span></code> class. The Promise class represents
a future event that will eventually occur. In the above example, <code class="docutils literal notranslate"><span class="pre">promise</span></code> represents
the eventual response from the HTTP request to <code class="docutils literal notranslate"><span class="pre">https://api.education.launchcode.org/weather</span></code>.</p>
<p>A promise can be fulfilled or rejected. When a promise is fulfilled, data is passed to the
response handler function. The <code class="docutils literal notranslate"><span class="pre">then</span></code> method of a promise defines what will happen when the
promise is fulfilled. When a promise is rejected an error reason is provided.</p>
<p>The above example can be translated to these steps</p>
<ol class="arabic simple">
<li>Make an HTTP request to <code class="docutils literal notranslate"><span class="pre">https://api.education.launchcode.org/weather</span></code></li>
<li>When the response is received THEN run the response handler function (passing in response data)</li>
<li>In the response handler function, console log the <code class="docutils literal notranslate"><span class="pre">response</span></code> object</li>
</ol>
</div>
<div class="section" id="more-promises">
<h2>24.4.3. More Promises<a class="headerlink" href="#more-promises" title="Permalink to this headline">¶</a></h2>
<p>Promises are used for more than HTTP requests. A promise can represent any future event.
The <code class="docutils literal notranslate"><span class="pre">response</span></code> object has a <code class="docutils literal notranslate"><span class="pre">json()</span></code> function that will return the JSON data in the
response. The <code class="docutils literal notranslate"><span class="pre">json()</span></code> function returns a promise that represents the future work result
of turned the response data into JSON.</p>
<p>The below example involves two promises. One promise on line 1 that represents the fetch
request and a second on line 3 that represents the response data being turned into JSON.</p>
<p>Finally on line 5 the JSON data can be logged.</p>
<div class="highlight-js notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">promise</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://api.education.launchcode.org/weather&#39;</span><span class="p">);</span>
<span class="nx">promise</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
   <span class="kr">const</span> <span class="nx">jsonPromise</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
   <span class="nx">jsonPromise</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;temp&quot;</span><span class="p">,</span> <span class="nx">json</span><span class="p">.</span><span class="nx">temp</span><span class="p">);</span>
   <span class="p">});</span>
<span class="p">}</span> <span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="admonition">
<p class="first admonition-title"><i class="fas fa-lightbulb" aria-hidden="true"></i>Tip</p>
<p class="last">Promises can be a hard concept to understand. Focus on the examples and the theory will
make sense in time.</p>
</div>
</div>
<div class="section" id="asynchronous-example">
<h2>24.4.4. Asynchronous Example<a class="headerlink" href="#asynchronous-example" title="Permalink to this headline">¶</a></h2>
<p>TODO: an example that shows a console.log statement happening before a response comes back</p>
</div>
</div>



    
    <nav aria-label="Next and Previous Pages">
      <ul class="pager">
        
        <li class="previous"><a href="fetch.html"><span aria-hidden="true">&larr;</span> 24.3. Fetching Data</a></li>
        
        
        <li class="next"><a href="exercises.html">24.5. Exercises <span aria-hidden="true">&rarr;</span></a></li>
        
      </ul>
    </nav>
    
    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>